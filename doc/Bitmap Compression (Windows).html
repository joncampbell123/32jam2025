<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns=http://www.w3.org/1999/xhtml><!--
 Page saved with SingleFile 
 url: http://nas.jmc/jmcs/docs/raw/File%20formats/BMP%2c%20Windows%20Bitmap/Bitmap%20Compression%2c%20by%20biCompression%20%282010%2d10%2d29%29%2ehtml 
 saved date: Tue Oct 28 2025 08:39:16 GMT-0700 (Pacific Daylight Time)
--><meta charset=utf-8>
<title>
 
 Bitmap Compression (Windows)
 
 </title>
<style>.cl_lw_toc_fade_top{background:url(data:,)no-repeat scroll -2623px -3px;width:1px;height:90px;overflow:hidden}body{margin:0;font-family:"Segoe UI",Verdana,Arial;font-size:.813em;color:#000;font-style:normal;padding-right:0;padding-left:0;word-wrap:break-word}a:link{color:#1364c4;text-decoration:none}a:hover{text-decoration:underline}a:visited{color:#960bb4;text-decoration:none}img{border:0}table{border-style:solid;border-width:1px;border-color:#bbb;border-collapse:collapse}table th{border-style:solid;border-width:1px;border-color:#bbb}table td{border-style:solid;border-width:1px;border-color:#bbb}.contentPlaceHolder{border-width:1px;text-align:left;width:100%;border-bottom-style:none;overflow:auto}.content{padding-top:13px;text-align:left;border-width:1px;overflow:auto;width:auto;border-left:1px solid #bbb;border-bottom:0}.topicContainer{padding-left:13px;padding-right:13px;padding-bottom:13px}.topicContainer .topic #mainSection{padding-top:5px}.topicContainer .topic .title{font-family:"Segoe UI",Verdana,Arial;font-size:1.769em;color:#3f529c;font-weight:bold}.topicContainer table{width:100%}.topicContainer table th{background-color:#e5e5e5;padding-right:4px;padding-left:4px;padding-bottom:4px;padding-top:4px;text-align:left;height:21px;font-family:"Segoe UI",Verdana,Arial;font-size:1.077em;color:#000;font-style:normal;font-weight:normal}.topicContainer table tr{vertical-align:top}.topicContainer table td{background-color:#fff;line-height:140%;padding-right:4px;padding-left:4px;padding-bottom:4px;margin:1px;padding-top:4px}.LW_CodeSnippetContainer{min-width:260px}.LW_CodeSnippetToolBar{width:auto;height:auto;border-top:solid 3px #e5e5e5;border-left:solid 1px #bbb;border-right:solid 3px #e5e5e5}.LW_CodeSnippetToolBarText{float:right;top:-10px;position:relative;background-color:#fff;width:auto;padding-left:4px;padding-right:4px;height:0}.LW_CodeSnippetToolBarText a:link,.LW_CodeSnippetToolBarText a:visited,.LW_CodeSnippetToolBarText a:active{margin-left:5px;margin-right:5px;text-decoration:none;color:#1364c4;font-family:"Segoe UI",Verdana,Arial;font-size:10pt;background-color:White;padding-left:4px;padding-right:4px}.LW_CodeSnippetToolBarText a:hover{margin-left:5px;margin-right:5px;text-decoration:none;color:#e66a38;font-family:"Segoe UI",Verdana,Arial;font-size:10pt;padding-left:4px;padding-right:4px}.LW_CodeSnippetContainerCodeCollection{border-left:solid 1px #bbb;border-bottom:solid 3px #e5e5e5;border-right:solid 1px #e5e5e5;clear:both;margin-bottom:12px;position:relative;top:-3px}.LW_CodeSnippetContainerCode{width:auto;margin:0;padding-right:21px;padding-left:21px}.LW_CodeSnippetContainerCode div{padding:0;margin:0}.LW_CodeSnippetContainerCode pre{padding:5px;margin:0;font-family:Consolas,Courier,monospace;word-break:break-all;word-wrap:break-word;font-style:normal;font-weight:normal;overflow:auto}.title{font-style:normal;font-variant:normal;line-height:normal;margin:0 0 10px}.TOC_Fade_Top{margin-left:-1px;position:absolute;margin-top:-13px}</style>
<meta name=DCS.dcsuri content="/en-us/library/dd183383(d=lightweight,l=en-us,v=VS.85).aspx">
<meta name=NormalizedUrl content="http://msdn.microsoft.com/en-us/library/dd183383(d=lightweight,l=en-us,v=VS.85).aspx">
<meta name=VotingContextUrl content="http://msdn.microsoft.com/en-us/library/dd183383(l=en-us,v=VS.85).aspx">
<meta name=MN content="D1DC116E-4:29:12 AM">
<meta name=Search.ShortId content=dd183383>
<meta name=Ms.Locale content=en-us>
<meta name=referrer content=no-referrer><link rel=canonical href=http://nas.jmc/jmcs/docs/raw/File%20formats/BMP%2c%20Windows%20Bitmap/Bitmap%20Compression%2c%20by%20biCompression%20%282010%2d10%2d29%29%2ehtml><meta http-equiv=content-security-policy content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:; object-src 'self' data:; frame-src 'self' data:;"><style>img[src="data:,"],source[src="data:,"]{display:none!important}</style></head>
 <body>
 <div class=contentPlaceHolder>
 <div class=content>
 <img class="TOC_Fade_Top cl_lw_toc_fade_top" src=data:, alt><div class=topicContainer>
 
 <div class=topic xmlns=http://www.w3.org/1999/xhtml>
 <h1 class=title>Bitmap Compression</h1>
 
 <div id=mainSection>
 <div class=clsServerSDKContent>
 
 </div>
 <p>Windows supports formats for compressing bitmaps that define their 
 colors with 8 or 4 bits-per-pixel. Compression reduces the disk and 
 memory storage required for the bitmap.</p>
 <p>When the <strong>Compression</strong> member of the bitmap 
 information header structure is BI_RLE8, a run-length encoding (RLE) 
 format is used to compress an 8-bit bitmap. This format can be 
 compressed in encoded or absolute modes. Both modes can occur anywhere 
 in the same bitmap:</p>
 <ul>
 <li>
 <strong>Encoded mode</strong> consists of two bytes: the first byte 
 specifies the number of consecutive pixels to be drawn using the color 
 index contained in the second byte. In addition, the first byte of the 
 pair can be set to zero to indicate an escape character that denotes the
 end of a line, the end of a bitmap, or a delta, depending on the value 
 of the second byte. The interpretation of the escape depends on the 
 value of the second byte of the pair, which can be one of the following 
 values.</li>
 </ul>
 <table><tbody>
 <tr>
 <th>Value</th>
 <th>Meaning</th>
 </tr>
 <tr>
 <td>0</td>
 <td>End of line.</td>
 </tr>
 <tr>
 <td>1</td>
 <td>End of bitmap.</td>
 </tr>
 <tr>
 <td>2</td>
 <td>Delta. The 2 bytes following the escape contain 
 unsigned values indicating the horizontal and vertical offsets of the 
 next pixel from the current position.</td>
 </tr>
 </table>
 <p>&nbsp;</p>
 <ul>
 <li>In <strong>absolute mode</strong>, the first byte is zero and the 
 second byte is a value in the range 03H through FFH. The second byte 
 represents the number of bytes that follow, each of which contains the 
 color index of a single pixel. When the second byte is two or less, the 
 escape has the same meaning as encoded mode. In absolute mode, each run 
 must be aligned on a word boundary.</li>
 </ul>
 <p>The following example shows the hexadecimal values of an 8-bit 
 compressed bitmap:</p>
 <div class=LW_CodeSnippetContainer xmlns>
 <a name=CodeSpippet0></a><div class=LW_CodeSnippetContainerCodeCollection>
 <div class=LW_CodeSnippetToolBar><div class=LW_CodeSnippetToolBarText><a title="Copy to clipboard.">Copy</a></div></div>
 <div id=CodeSnippetContainerCode0 class=LW_CodeSnippetContainerCode><div style=color:Black><pre>03 04 05 06 00 03 45 56 67 00 02 78 00 02 05 01 
02 78 00 00 09 1E 00 01 


</pre></div></div>
 </div>
 </div>
 <p>The bitmap expands as follows (two-digit values represent a color 
 index for a single pixel):</p>
 <div class=LW_CodeSnippetContainer xmlns>
 <a name=CodeSpippet1></a><div class=LW_CodeSnippetContainerCodeCollection>
 <div class=LW_CodeSnippetToolBar><div class=LW_CodeSnippetToolBarText><a title="Copy to clipboard.">Copy</a></div></div>
 <div id=CodeSnippetContainerCode1 class=LW_CodeSnippetContainerCode><div style=color:Black><pre>04 04 04 
06 06 06 06 06 
45 56 67 
78 78 
move current position 5 right and 1 down 
78 78 
end of line 
1E 1E 1E 1E 1E 1E 1E 1E 1E 
end of RLE bitmap 


</pre></div></div>
 </div>
 </div>
 <p>When the <strong>Compression</strong> member is BI_RLE4, the bitmap 
 is compressed by using a run-length encoding format for a 4-bit bitmap, 
 which also uses encoded and absolute modes:</p>
 <ul>
 <li>In encoded mode, the first byte of the pair contains the number of 
 pixels to be drawn using the color indexes in the second byte. The 
 second byte contains two color indexes, one in its high-order 4 bits and
 one in its low-order 4 bits. The first of the pixels is drawn using the
 color specified by the high-order 4 bits, the second is drawn using the
 color in the low-order 4 bits, the third is drawn using the color in 
 the high-order 4 bits, and so on, until all the pixels specified by the 
 first byte have been drawn.</li>
 <li>In absolute mode, the first byte is zero. The second byte contains 
 the number of color indexes that follow. Subsequent bytes contain color 
 indexes in their high- and low-order 4 bits, one color index for each 
 pixel. In absolute mode, each run must be aligned on a word boundary. 
 The end-of-line, end-of-bitmap, and delta escapes described for BI_RLE8 
 also apply to BI_RLE4 compression.</li>
 </ul>
 <p>The following example shows the hexadecimal values of a 4-bit 
 compressed bitmap:</p>
 <div class=LW_CodeSnippetContainer xmlns>
 <a name=CodeSpippet2></a><div class=LW_CodeSnippetContainerCodeCollection>
 <div class=LW_CodeSnippetToolBar><div class=LW_CodeSnippetToolBarText><a title="Copy to clipboard.">Copy</a></div></div>
 <div id=CodeSnippetContainerCode2 class=LW_CodeSnippetContainerCode><div style=color:Black><pre>03 04 05 06 00 06 45 56 67 00 04 78 00 02 05 01 
04 78 00 00 09 1E 00 01 


</pre></div></div>
 </div>
 </div>
 <p>The bitmap expands as follows (single-digit values represent a color 
 index for a single pixel):</p>
 <div class=LW_CodeSnippetContainer xmlns>
 <a name=CodeSpippet3></a><div class=LW_CodeSnippetContainerCodeCollection>
 <div class=LW_CodeSnippetToolBar><div class=LW_CodeSnippetToolBarText><a title="Copy to clipboard.">Copy</a></div></div>
 <div id=CodeSnippetContainerCode3 class=LW_CodeSnippetContainerCode><div style=color:Black><pre>0 4 0 
0 6 0 6 0 
4 5 5 6 6 7 
7 8 7 8 
move current position 5 right and 1 down 
7 8 7 8 
end of line 
1 E 1 E 1 E 1 E 1 
end of RLE bitmap 


</pre></div></div>
 </div>
 </div>
 <p>Build date: 10/29/2010</p>
 <div class=copyright>Â© 2010 Microsoft Corporation. All rights reserved.</div>
 </div>
 </div>
 </div>
 
 </div>
 </div>
 
 
